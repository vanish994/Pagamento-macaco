
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gerar Pix</title>
  <style>
    body { font-family: sans-serif; max-width: 500px; margin: 40px auto; padding: 20px; }
    input, button { width: 100%; padding: 10px; margin: 10px 0; }
    #qrcode { text-align: center; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>Gerar Pix</h2>
  <input id="name" placeholder="Nome completo" required/>
  <input id="email" placeholder="Email" required/>
  <input id="document" placeholder="CPF ou CNPJ (somente nÃºmeros)" required/>
  <input id="phone" placeholder="Telefone com DDD" required/>
  <input id="amount" placeholder="Valor (Ex: 50.00)" required/>
  <button onclick="gerarPix()">Gerar Pix</button>
  <p id="error" style="color:red;"></p>
  <p id="pixcode" style="word-break: break-all;"></p>
  <div id="qrcode"></div>

  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    async function gerarPix() {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const document = document.getElementById('document').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const amount = document.getElementById('amount').value.trim();
      const error = document.getElementById('error');
      const pixcode = document.getElementById('pixcode');
      const qrcode = document.getElementById('qrcode');

      error.textContent = '';
      pixcode.textContent = '';
      qrcode.innerHTML = '';

      try {
        const response = await fetch('https://app.duckfy.com.br/api/v1/gateway/pix/receive', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'public-key': 'iago-ruan0609_pwjpdypt6q8eg3fc',
            'private-key': 'c40aw13c47m4xz3294av56v5o5dilvjitrhci9orrh5uhoeklwiusvl1frful4xq'
          },
          body: JSON.stringify({
            identifier: Date.now().toString(),
            amount: parseFloat(amount),
            client: {
              name,
              email,
              document,
              phone
            }
          })
        });

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.message || 'Erro ao gerar Pix');
        }

        pixcode.textContent = data.pixInformation.emv;
        QRCode.toCanvas(document.createElement("canvas"), data.pixInformation.emv, (err, canvas) => {
          if (!err) qrcode.appendChild(canvas);
        });

      } catch (err) {
        error.textContent = 'Erro: ' + err.message;
      }
    }
  </script>
</body>
</html>
